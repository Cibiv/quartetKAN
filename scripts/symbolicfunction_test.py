import numpy as np
import pandas as pd
import tensorflow.keras as keras
from keras import backend as K
import tensorflow as tf
import argparse
import logging
import os
import seaborn as sns
import matplotlib
import matplotlib.pyplot as plt
from pylab import *

#matplotlib.use('Agg')

# pass arguments with flags
#parser = argparse.ArgumentParser()

#parser.add_argument("-m", "--model", help = "Model to test.")
#parser.add_argument("-t", "--test", default = '../data/processed/zone/test/1000bp', help = "Path to test directory")
#parser.add_argument("-l", "--seqlen", default = '1000bp', help = "Sequence Length")
#parser.add_argument("-o", "--offset", type = int, default = 4, help = "Index of first feature column.")
#parser.add_argument("-n", "--no_feat", type = int, default = 15, help = "Number of feature columns.")
#args = vars(parser.parse_args())

#model = keras.saving.load_model(args['model'])

#print the model summary
#model.summary()

#modell laden:
model = keras.saving.load_model('../models/F-zoneNN_20250116_140646_020-0.819-0.820')
#anschauen was es für layer gibt: [15,4,2,1],index: 0 -> 4,1 -> 2,2->1 also 4 und 2 sind DenseKAN und 1 ist normal, 15 ist die Größe vom input
model.summary()
#auf den i-ten layer des models mit models.layers[i] zugreifen
#print(model.layers[0])
#<keras.src.saving.legacy.saved_model.load.DenseKAN object at 0x7f8efa866350>
#print(model.layers[1])
#<keras.src.saving.legacy.saved_model.load.DenseKAN object at 0x7f8efa7dfd10>
#print(model.layers[2])
#<keras.src.layers.core.dense.Dense object at 0x7f8efa202f50>

#für dense layers erhält man die weights mit model.layers[i].weights
#print(model.layers[2].weights)
#[<tf.Variable 'dense/kernel:0' shape=(2, 1) dtype=float32, numpy=
#array([[ 2.5388613e+00],
 #      [-1.0384964e-03]], dtype=float32)>, <tf.Variable 'dense/bias:0' shape=(1,) dtype=float32, numpy=array([-0.52242494], dtype=float32)>]
#in meiner letzten laydr werden also die zwei nodes, die von der zweiten hidden layer übergeben werden mit 2.5 und -1.0 multipliziert, 
#dann -0.5224 dazuaddiert und dann durch die sigmoid funktion gegeben für den output

#wie erhalte ich die weights und aktivierungsfunktionen von den hidden layers?
#inspiration bei pykan für die symbolic function
#print(model.layers[1].weights)
"""[<tf.Variable 'dense_kan_1/spline_kernel:0' shape=(4, 8, 2) dtype=float32, numpy=
array([[[ 1.2408248 ,  0.6007983 ],
        [ 0.92225593,  0.34695032],
        [-1.1237121 , -0.72650015],
        [-3.1709268 , -1.743789  ],
        [-5.539622  , -4.0989113 ],
        [-0.31851938, -0.7420227 ],
        [ 0.0976807 , -0.7406196 ],
        [ 1.2272903 ,  0.7075231 ]],

       [[-0.4713877 ,  2.1175296 ],
        [ 0.36328027,  1.3970504 ],
        [ 1.0262586 , -0.03407883],
        [ 1.2201215 , -0.48507842],
        [ 1.6582799 , -1.0502591 ],
        [-0.31799054,  0.5480379 ],
        [ 0.14940225, -0.4797849 ],
        [ 0.3275606 , -1.872456  ]],

       [[-0.68110937, -0.8740852 ],
        [-1.1184362 , -0.8503553 ],
        [-1.9171951 , -1.3097199 ],
        [-1.5326462 , -0.63965917],
        [-0.87781453, -0.65528256],
        [ 1.5727004 ,  1.0952253 ],
        [ 1.7911612 , -0.2908777 ],
        [ 4.7530837 ,  2.543891  ]],

       [[ 1.394718  ,  1.6258446 ],
        [ 0.26839685,  0.03791697],
        [-0.89680916, -1.5997666 ],
        [-0.6970364 , -0.7397104 ],
        [-1.3714889 , -1.2127262 ],
        [ 2.8874383 ,  2.057014  ],
        [ 1.236367  ,  0.7994961 ],
        [ 0.4134899 ,  1.1370059 ]]], dtype=float32)>, <tf.Variable 'dense_kan_1/scale_factor:0' shape=(4, 2) dtype=float32, numpy=
array([[-0.6611737 ,  0.19429201],
       [-2.8217506 , -0.2748935 ],
       [ 1.6778848 , -0.53418183],
       [ 1.3091022 , -0.24741721]], dtype=float32)>, <tf.Variable 'dense_kan_1/bias:0' shape=(2,) dtype=float32, numpy=array([-0.55845827,  0.5807731 ], dtype=float32)>, <tf.Variable 'dense_kan_1/spline_grid:0' shape=(4, 12) dtype=float32, numpy=
array([[-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]

"""
#print(model.layers[0].weights)
"""
[<tf.Variable 'dense_kan/spline_kernel:0' shape=(15, 8, 4) dtype=float32, numpy=
array([[[-3.12618278e-02,  1.80752859e-01, -1.38746917e-01,
          2.34571695e-01],
        [ 3.43982540e-02, -6.99465945e-02, -7.55850449e-02,
          9.46318805e-02],
        [ 2.06867719e+00,  2.59305787e+00, -4.34537935e+00,
          3.16595435e+00],
        [ 3.92934769e-01, -6.48661375e-01,  2.17633530e-01,
         -5.37181020e-01],
        [-2.60797173e-01,  2.51950562e-01, -3.44179809e-01,
          1.14597313e-01],
        [-8.40003192e-01,  8.81005079e-02,  3.11653763e-01,
          2.05983475e-01],
        [-1.00263619e+00,  8.39046985e-02,  5.47479331e-01,
          3.45997095e-01],
        [ 7.41722918e+00,  2.16032839e+00,  2.13136315e+00,
          1.06595242e+00]],

       [[ 4.23220284e-02,  1.24579072e-01,  1.86350241e-01,
         -1.42037577e-03],
        [-3.18756625e-02,  7.74744004e-02,  5.66642098e-02,
          7.82829449e-02],
        [-1.11035550e+00,  4.80982018e+00,  3.90136170e+00,
          1.76209259e+00],
        [ 8.94772410e-01,  9.64042187e-01, -6.85967386e-01,
         -7.51021206e-01],
        [-6.81121826e-01, -7.62274206e-01,  3.04743677e-01,
          5.94282031e-01],
        [ 5.17166495e-01,  7.35505939e-01,  1.54038280e-01,
         -1.52208996e+00],
        [-2.14133310e+00, -3.00578003e+01, -7.38838501e+01,
          3.99327965e+01],
        [-1.21526513e-02,  8.32402334e-02, -1.47023201e-02,
         -7.52700791e-02]],

       [[ 2.57527471e-01,  9.14936587e-02, -6.88351244e-02,
         -2.81703081e-02],
        [-1.38872219e-02, -8.46173167e-02, -1.76442228e-02,
          3.12311258e-02],
        [-3.75766802e+00,  5.09301949e+00,  5.99827051e+00,
         -4.43955612e+00],
        [-8.68784308e-01, -6.88256443e-01, -5.54206269e-03,
          9.28962350e-01],
        [ 7.16742754e-01,  4.91730869e-01, -2.95621812e-01,
         -7.15871334e-01],
        [-1.29404914e+00, -1.48280263e+00,  1.58701622e+00,
          7.50681758e-01],
        [ 3.41259956e+01,  3.28036232e+01, -2.36769509e+00,
         -1.08935194e+01],
        [ 3.27806436e-02,  1.57308146e-01, -9.56627354e-02,
         -3.96389328e-02]],

       [[-5.92496581e-02, -8.30124617e-02, -1.09692179e-01,
         -1.00231946e-01],
        [-8.37238058e-02,  5.43608330e-02, -4.21705320e-02,
         -1.59501716e-01],
        [ 2.17066121e+00, -5.24866343e+00,  2.47668910e+00,
         -8.79580498e+00],
        [ 7.22550079e-02, -4.24978793e-01, -7.22931623e-01,
          1.43379152e-01],
        [-3.66220862e-01,  5.99068582e-01,  3.55278701e-01,
          1.26865298e-01],
        [ 3.41201758e+00, -2.08791637e+00,  1.07575428e+00,
         -1.80651891e+00],
        [-1.71798265e+00, -3.95020676e+00,  3.69820428e+00,
         -2.53359914e+00],
        [-5.94311915e-02,  1.71106383e-01,  6.15898669e-02,
         -1.63908958e-01]],

       [[-1.44338280e-01,  9.20351874e-03,  1.84512019e-01,
         -8.02324191e-02],
        [ 7.08874315e-02,  3.78237888e-02,  4.24081385e-02,
          5.70861511e-02],
        [ 2.82333523e-01, -5.86167049e+00,  2.43983746e-01,
          5.13768768e+00],
        [-4.93645012e-01,  3.23891602e-02,  6.07990265e-01,
         -1.94411695e-01],
        [ 4.32378538e-02,  1.68197781e-01, -5.74075758e-01,
         -1.64275020e-01],
        [ 2.59017253e+00, -1.85718095e+00,  1.21199715e+00,
          1.79016256e+00],
        [ 1.17024126e+01,  3.24898767e+00,  1.12385426e+01,
         -1.83405037e+01],
        [-8.68220534e-03, -4.88743819e-02, -1.69418789e-02,
          1.66875288e-01]],

       [[-8.71267244e-02, -4.94228341e-02,  7.92539772e-03,
          1.72750160e-01],
        [ 3.73563133e-02, -4.86818403e-02, -2.23371554e-02,
          4.17639837e-02],
        [ 5.95769501e+00, -2.44936681e+00,  7.08057785e+00,
         -2.14968204e+00],
        [ 1.07423830e+00, -7.83001959e-01, -6.09793723e-01,
         -8.07840049e-01],
        [-8.31710160e-01,  6.46167457e-01,  2.24188834e-01,
          5.93515098e-01],
        [ 8.08582366e-01, -1.72280216e+00, -9.09206644e-02,
         -1.28272736e+00],
        [-4.75119934e+01,  4.59802132e+01, -7.26738358e+01,
          1.23119240e+01],
        [-7.38252401e-02,  1.33404016e-01,  1.92014109e-02,
         -1.06880181e-01]],

       [[-9.48442668e-02,  1.43550500e-01,  4.82123829e-02,
         -1.47772968e-01],
        [-2.02684458e-02, -4.34846319e-02,  1.10134758e-01,
         -1.53519064e-01],
        [-1.24537897e+00, -7.69365120e+00, -6.25626850e+00,
         -4.64596367e+00],
        [ 7.40278214e-02,  1.16816320e-01,  1.92415640e-01,
         -4.53567475e-01],
        [ 2.12713242e-01,  9.99637172e-02,  3.38488743e-02,
          6.46450460e-01],
        [-4.21333504e+00, -1.66479528e+00, -1.55177569e+00,
         -2.24059272e+00],
        [ 6.04572201e+00,  7.44330454e+00, -4.78594685e+00,
         -9.02058482e-01],
        [-5.28006218e-02, -1.45666972e-01,  2.38841966e-01,
          7.09327459e-02]],

       [[ 3.27888429e-02,  1.22936063e-01,  1.22483127e-01,
          3.80630903e-02],
        [ 3.23270522e-02, -6.95345178e-02,  4.15884852e-02,
         -5.87206967e-02],
        [ 5.49348497e+00, -1.84468842e+00,  8.10175610e+00,
         -1.23499417e+00],
        [-6.59726679e-01, -8.91419172e-01, -9.77944061e-02,
         -3.74053538e-01],
        [ 1.57101691e-01,  5.06105483e-01, -5.38447080e-03,
         -1.84752047e-02],
        [ 1.10021830e+00, -3.39582235e-01, -8.04456174e-01,
          2.04917169e+00],
        [-1.84542656e+01,  1.45851648e+00,  1.73334432e+00,
          2.15996513e+01],
        [-3.27282883e-02, -5.22613525e-02, -1.50266767e-01,
          1.15238605e-02]],

       [[ 6.66487217e-02,  3.85546573e-02, -2.55814046e-02,
         -1.33585557e-01],
        [-8.62887949e-02, -1.44981286e-02, -8.69715288e-02,
         -1.23491488e-01],
        [-4.72193241e+00, -3.49281836e+00,  1.34008145e+00,
         -1.96284842e+00],
        [-6.80253685e-01, -5.08634746e-01, -2.67349422e-01,
         -6.39460087e-01],
        [ 5.52499354e-01,  5.87957501e-01, -1.75889000e-01,
          5.27834952e-01],
        [-9.38793063e-01, -2.39757991e+00,  4.02519274e+00,
         -7.26254404e-01],
        [-2.26410561e+01, -2.46466484e+01, -1.62422714e+01,
         -6.18916416e+00],
        [ 1.00829840e-01, -4.00359817e-02,  4.06935625e-02,
         -9.50220749e-02]],

       [[-5.08586243e-02,  1.45138010e-01,  8.64442140e-02,
         -7.04909489e-02],
        [ 2.21547231e-01, -6.59720227e-02,  4.72325049e-02,
         -3.18268016e-02],
        [-1.14897287e+00,  4.36930132e+00, -6.55143309e+00,
         -5.04515600e+00],
        [ 4.80802566e-01, -7.57053673e-01,  1.51612803e-01,
         -6.35761559e-01],
        [-4.04975563e-01,  5.44963658e-01,  1.54509351e-01,
          4.79931802e-01],
        [ 4.84618574e-01, -1.45445585e+00, -2.14958692e+00,
         -8.99545252e-01],
        [ 1.27941380e+01,  7.96625233e+00,  4.98195000e+01,
         -2.45670242e+01],
        [ 1.29426485e-02, -1.10520683e-01, -1.87527418e-01,
         -1.79274138e-02]],

       [[ 4.70201410e-02,  2.00125679e-01, -1.81134969e-01,
         -2.51173470e-02],
        [ 5.93773089e-02,  1.97377242e-02,  9.02299955e-02,
          1.67789534e-01],
        [-2.12468076e+00,  3.20653534e+00, -1.69412184e+00,
          1.63308072e+00],
        [-9.63006541e-02, -3.53528202e-01, -6.90913856e-01,
         -4.08210978e-02],
        [ 2.76847541e-01,  1.75017938e-02,  2.75213182e-01,
         -2.07938269e-01],
        [-2.58252144e+00,  9.65909600e-01,  1.35333610e+00,
          1.54607451e+00],
        [ 2.34597549e+01, -3.38878174e+01,  2.35077858e+01,
         -6.55646667e+01],
        [-7.89086446e-02,  1.19001381e-01, -1.11469366e-01,
         -1.52526230e-01]],

       [[-2.61915445e-01,  2.33289767e-02, -4.85566966e-02,
          5.82944369e-03],
        [-3.35479592e-04, -5.68741374e-02,  1.43653661e-01,
          9.41598937e-02],
        [-3.79229903e+00,  3.40520668e+00, -1.10565281e+00,
          1.17571294e+00],
        [ 6.78785920e-01, -4.39573795e-01, -8.22541595e-01,
         -6.70937914e-03],
        [-5.75916886e-01,  1.36042222e-01,  3.75324070e-01,
         -2.44952023e-01],
        [ 1.28783274e+00,  2.98003763e-01,  1.17113042e+00,
          1.76865458e+00],
        [-1.45663481e+01, -3.17631092e+01,  3.22600136e+01,
         -6.78543243e+01],
        [-1.87041119e-01,  1.88453242e-01, -5.32789342e-02,
          7.19500929e-02]],

       [[ 3.67049836e-02, -1.24651350e-01,  3.44280303e-02,
          1.06420673e-01],
        [ 1.68572307e-01, -1.69983450e-02,  1.38488948e-01,
         -5.30323684e-02],
        [ 1.18449318e+00,  4.49762249e+00,  5.96761560e+00,
          6.02634478e+00],
        [-6.41663611e-01, -4.60613370e-02, -2.42658496e-01,
          2.92824298e-01],
        [ 1.66974634e-01, -3.04663420e-01, -6.92590550e-02,
         -4.49094921e-01],
        [ 2.29242325e+00,  2.39386439e+00,  9.41184580e-01,
          1.39934516e+00],
        [-9.87068939e+00, -7.96086836e+00, -9.49176216e+00,
          1.16907072e+00],
        [-5.23905829e-02, -8.44845995e-02, -5.08487411e-02,
          1.30820051e-02]],

       [[-2.17913270e-01,  1.87991243e-02, -8.82319734e-02,
         -1.06861606e-01],
        [ 9.98045206e-02,  7.83938020e-02, -4.69920365e-03,
          1.60125062e-01],
        [-4.73235416e+00, -4.99734163e+00, -2.54834700e+00,
          4.85230446e+00],
        [ 7.61996686e-01, -4.74481106e-01,  8.21481824e-01,
          1.06855714e+00],
        [-2.36591995e-01,  3.86795253e-01, -4.09384459e-01,
         -8.01619768e-01],
        [-2.35602832e+00, -9.72969174e-01, -1.53171551e+00,
          5.60786247e-01],
        [ 2.53538761e+01, -1.04327643e+00,  9.57492542e+00,
          5.19766521e+00],
        [-6.18510135e-02,  8.67364034e-02, -1.49909798e-02,
          1.28315493e-01]],

       [[-2.38022823e-02,  1.70223694e-02,  1.49177402e-01,
         -1.33858144e-01],
        [-7.21905753e-02, -3.86472270e-02, -7.30431303e-02,
         -6.21522032e-02],
        [-9.77204800e-01,  3.62257528e+00,  4.07618135e-01,
          2.35819936e+00],
        [ 6.16837293e-02, -3.58111501e-01,  9.57972631e-02,
         -3.28074753e-01],
        [ 2.73768678e-02, -6.59911856e-02, -9.84350517e-02,
         -6.10300861e-02],
        [-1.28146327e+00,  2.19744301e+00, -3.29614192e-01,
          1.99182677e+00],
        [-1.50525514e-02,  6.86312392e-02, -1.15750276e-01,
         -2.47713160e-02],
        [ 1.58429161e-01,  1.37405202e-01,  4.79159541e-02,
          8.66681859e-02]]], dtype=float32)>, <tf.Variable 'dense_kan/scale_factor:0' shape=(15, 4) dtype=float32, numpy=
array([[-4.4526514e-01, -3.8716778e-01, -5.4314756e-01, -3.8155749e-01],
       [ 2.5188112e-01,  1.6576015e+00, -1.2769710e+00,  2.3156893e+00],
       [ 2.8762758e+00,  3.8155668e+00, -6.0586166e-01, -3.2870142e+00],
       [ 2.3170738e+00,  1.9102683e+00,  4.1552556e-01, -2.7528591e+00],
       [ 1.2904665e+00,  5.8701855e-01, -2.5454587e-01,  1.0683497e+00],
       [ 3.1773891e+00, -1.7249975e+00, -2.2615273e+00, -1.5077929e+00],
       [-2.2865126e+00, -2.5325115e+00, -2.2880070e+00,  1.8516320e+00],
       [-2.1824694e+00, -2.0648756e+00,  1.4093418e+00,  3.1865162e-01],
       [-1.5525393e+00,  1.3808203e+00, -3.4805756e+00,  1.0142148e+00],
       [ 4.1116908e-01,  3.0090799e+00,  1.1208693e+00, -1.5139469e+00],
       [ 5.5412644e-01,  3.3129263e-01, -7.2604775e-01,  6.4283252e-01],
       [-9.9756324e-01,  3.7252262e-01, -6.6424721e-01,  6.6850162e-01],
       [ 1.1966815e+00,  9.5215309e-01,  5.9041166e-01, -3.9661065e-01],
       [ 1.9663942e+00,  3.7977353e-01, -4.6274999e-01,  2.1887231e+00],
       [-2.0849868e-03, -3.6019781e-01, -3.8937011e-04, -1.5135147e-01]],
      dtype=float32)>, <tf.Variable 'dense_kan/bias:0' shape=(4,) dtype=float32, numpy=array([0.048146  , 0.09397293, 0.11717802, 0.10348473], dtype=float32)>, <tf.Variable 'dense_kan/spline_grid:0' shape=(15, 12) dtype=float32, numpy=
array([[-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
       [ 2.3170738e+00,  1.9102683e+00,  4.1552556e-01, -2.7528591e+00],
       [ 1.2904665e+00,  5.8701855e-01, -2.5454587e-01,  1.0683497e+00],
       [ 3.1773891e+00, -1.7249975e+00, -2.2615273e+00, -1.5077929e+00],
       [-2.2865126e+00, -2.5325115e+00, -2.2880070e+00,  1.8516320e+00],
       [-2.1824694e+00, -2.0648756e+00,  1.4093418e+00,  3.1865162e-01],
       [-1.5525393e+00,  1.3808203e+00, -3.4805756e+00,  1.0142148e+00],
       [ 4.1116908e-01,  3.0090799e+00,  1.1208693e+00, -1.5139469e+00],
       [ 5.5412644e-01,  3.3129263e-01, -7.2604775e-01,  6.4283252e-01],
       [-9.9756324e-01,  3.7252262e-01, -6.6424721e-01,  6.6850162e-01],
       [ 1.1966815e+00,  9.5215309e-01,  5.9041166e-01, -3.9661065e-01],
       [ 1.9663942e+00,  3.7977353e-01, -4.6274999e-01,  2.1887231e+00],
       [-2.0849868e-03, -3.6019781e-01, -3.8937011e-04, -1.5135147e-01]],
      dtype=float32)>, <tf.Variable 'dense_kan/bias:0' shape=(4,) dtype=float32, numpy=array([0.048146  , 0.09397293, 0.11717802, 0.10348473], dtype=float32)>, <tf.Variable 'dense_kan/spline_grid:0' shape=(15, 12) dtype=float32, numpy=
array([[-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
       [ 2.3170738e+00,  1.9102683e+00,  4.1552556e-01, -2.7528591e+00],
       [ 1.2904665e+00,  5.8701855e-01, -2.5454587e-01,  1.0683497e+00],
       [ 3.1773891e+00, -1.7249975e+00, -2.2615273e+00, -1.5077929e+00],
       [-2.2865126e+00, -2.5325115e+00, -2.2880070e+00,  1.8516320e+00],
       [-2.1824694e+00, -2.0648756e+00,  1.4093418e+00,  3.1865162e-01],
       [-1.5525393e+00,  1.3808203e+00, -3.4805756e+00,  1.0142148e+00],
       [ 4.1116908e-01,  3.0090799e+00,  1.1208693e+00, -1.5139469e+00],
       [ 5.5412644e-01,  3.3129263e-01, -7.2604775e-01,  6.4283252e-01],
       [-9.9756324e-01,  3.7252262e-01, -6.6424721e-01,  6.6850162e-01],
       [ 1.1966815e+00,  9.5215309e-01,  5.9041166e-01, -3.9661065e-01],
       [ 1.9663942e+00,  3.7977353e-01, -4.6274999e-01,  2.1887231e+00],
       [-2.0849868e-03, -3.6019781e-01, -3.8937011e-04, -1.5135147e-01]],
      dtype=float32)>, <tf.Variable 'dense_kan/bias:0' shape=(4,) dtype=float32, numpy=array([0.048146  , 0.09397293, 0.11717802, 0.10348473], dtype=float32)>, <tf.Variable 'dense_kan/spline_grid:0' shape=(15, 12) dtype=float32, numpy=
array([[-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts>
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
(kan) lea@davinci:/project/phyloAI/quartetKAN/scripts> 
array([[-4.4526514e-01, -3.8716778e-01, -5.4314756e-01, -3.8155749e-01],
       [ 2.5188112e-01,  1.6576015e+00, -1.2769710e+00,  2.3156893e+00],
       [ 2.8762758e+00,  3.8155668e+00, -6.0586166e-01, -3.2870142e+00],
       [ 2.3170738e+00,  1.9102683e+00,  4.1552556e-01, -2.7528591e+00],
       [ 1.2904665e+00,  5.8701855e-01, -2.5454587e-01,  1.0683497e+00],
       [ 3.1773891e+00, -1.7249975e+00, -2.2615273e+00, -1.5077929e+00],
       [-2.2865126e+00, -2.5325115e+00, -2.2880070e+00,  1.8516320e+00],
       [-2.1824694e+00, -2.0648756e+00,  1.4093418e+00,  3.1865162e-01],
       [-1.5525393e+00,  1.3808203e+00, -3.4805756e+00,  1.0142148e+00],
       [ 4.1116908e-01,  3.0090799e+00,  1.1208693e+00, -1.5139469e+00],
       [ 5.5412644e-01,  3.3129263e-01, -7.2604775e-01,  6.4283252e-01],
       [-9.9756324e-01,  3.7252262e-01, -6.6424721e-01,  6.6850162e-01],
       [ 1.1966815e+00,  9.5215309e-01,  5.9041166e-01, -3.9661065e-01],
       [ 1.9663942e+00,  3.7977353e-01, -4.6274999e-01,  2.1887231e+00],
       [-2.0849868e-03, -3.6019781e-01, -3.8937011e-04, -1.5135147e-01]],
      dtype=float32)>, <tf.Variable 'dense_kan/bias:0' shape=(4,) dtype=float32, numpy=array([0.048146  , 0.09397293, 0.11717802, 0.10348473], dtype=float32)>, <tf.Variable 'dense_kan/spline_grid:0' shape=(15, 12) dtype=float32, numpy=
array([[-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ],
       [-2.2       , -1.8000001 , -1.4000001 , -1.        , -0.6       ,
        -0.20000005,  0.20000005,  0.5999999 ,  1.        ,  1.4000001 ,
         1.8       ,  2.2       ]], dtype=float32)>]
"""


